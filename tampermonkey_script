// ==UserScript==
// @name     MAGGA script
// @description remove ads from geoguessr pages
// @version  0.5
// @author  .flamby.
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @include        /^(https?)?(\:)?(\/\/)?([^\/]*\.)?geoguessr\.com($|\/.*)/
// @grant GM.getResourceUrl
// @resource bg1 https://super-duper.fr/img/magga/bg01.jpg
// @resource bg2 https://super-duper.fr/img/magga/bg02.jpg
// @resource bg3 https://super-duper.fr/img/magga/bg03.jpg
// @resource bg4 https://super-duper.fr/img/magga/bg04.jpg
// @resource bg5 https://super-duper.fr/img/magga/bg05.jpg
// @resource bg6 https://super-duper.fr/img/magga/bg06.jpg
// @resource bg7 https://super-duper.fr/img/magga/bg07.jpg
// @resource bg8 https://super-duper.fr/img/magga/bg08.jpg
// @resource bg9 https://super-duper.fr/img/magga/bg09.jpg
// @resource bg10 https://super-duper.fr/img/magga/bg10.jpg
// @resource bg11 https://super-duper.fr/img/magga/bg11.jpg
// @resource bg12 https://super-duper.fr/img/magga/bg12.jpg
// @resource bg13 https://super-duper.fr/img/magga/bg13.jpg
// @resource bg14 https://super-duper.fr/img/magga/bg14.jpg
// @resource bg15 https://super-duper.fr/img/magga/bg15.jpg
// @resource bg16 https://super-duper.fr/img/magga/bg16.jpg
// @resource bg17 https://super-duper.fr/img/magga/bg17.jpg
// @resource bg18 https://super-duper.fr/img/magga/bg18.jpg
// @resource bg19 https://super-duper.fr/img/magga/bg19.jpg
// @resource bg20 https://super-duper.fr/img/magga/bg20.jpg
// @resource bg21 https://super-duper.fr/img/magga/bg21.jpg
// @resource bg22 https://super-duper.fr/img/magga/bg22.jpg
// @resource bg23 https://super-duper.fr/img/magga/bg23.jpg
// @resource bg24 https://super-duper.fr/img/magga/bg24.jpg
// @resource bg25 https://super-duper.fr/img/magga/bg25.jpg
// @resource bg26 https://super-duper.fr/img/magga/bg26.jpg
// @resource bg27 https://super-duper.fr/img/magga/bg27.jpg
// @resource bg28 https://super-duper.fr/img/magga/bg28.jpg
// @resource bg29 https://super-duper.fr/img/magga/bg29.jpg
// @resource bg30 https://super-duper.fr/img/magga/bg30.jpg
// @resource bg31 https://super-duper.fr/img/magga/bg31.jpg
// @resource bg32 https://super-duper.fr/img/magga/bg32.jpg
// @resource bg33 https://super-duper.fr/img/magga/bg33.jpg
// @resource bg34 https://super-duper.fr/img/magga/bg34.jpg
// @resource multi_country https://super-duper.fr/img/magga/flag.png
// @resource multi_duel https://super-duper.fr/img/magga/duel.png
// @resource multi_distance https://super-duper.fr/img/magga/distance.png
// @resource single_quickplay https://super-duper.fr/img/magga/earth5.png
// @resource single_maprunner https://super-duper.fr/img/magga/runner.png
// @resource single_classic https://super-duper.fr/img/magga/map_icon2.png
// @resource single_explorer https://super-duper.fr/img/magga/explorer.png
// @resource single_streak https://super-duper.fr/img/magga/streak.png
// @resource single_daily https://super-duper.fr/img/magga/calendar.png
// @resource multi_season_icon https://super-duper.fr/img/magga/beach.png
// @resource live_icon https://super-duper.fr/img/magga/live2.png
// @run-at document-start
// ==/UserScript==
// MAke Geoguessr Great Again
// background images come from Pexel.


//------------------------------------------------------------------------------------------------------------OPTIONS ----------------------------------------------------------------------------------\\
var dailyBackground = false; // if set to false, your background will be the same everyday. if set to true, your background will cycle through bg1 to bg31 depending on the day of the month
var singleBackground = "bg5"; // your background, you can choose from bg1 to bg31, you can also change the URL in the @ressource area to choose any image on the internet. beware : large images may result in visual glitches during page load.

var mainPageBackground = true; // true = replace the main page background.
var menusBackground = true; // true = replace the single player and multiplayer pages background.
var lobbyBackground = true; //true = replace the multiplayer lobbys background;

var singlePlayerIcons = true; // true = replace avatars with nice icons in single player menu.
var multiplayerIcons = true; // true = replace avatars with nice icons in multiplayer menu.

var bg_color = "rgba(14,31,40,0.7)"; // background color for the blocks in single player and multiplayer menus.
var bg_color_darker = "hsla(0,0%,100%,.1)"; // background color for multiplayer ranked blocks.

//------------------------------------------------------------------------------------------------------CODE---------------------------------------------------------------------------------------------\\

//list of elements to remove from all pages
var elementList = [ "deal-promo-button_root__nUfyK", //avatars ads
                   "slanted-button_container__6JmyZ", //avatar ads
                   "maprunner-signed-in-start-page_backgroundWrapper__LOeXW", //main page maprunner background
                   "maprunner-signed-in-start-page_avatar__gAHLT", //main page giant avatar
                   "primary-menu-button_flair__DERJi", //yellow new season button
                   "footer_footer__tc8Gv", //social medias links
                   "promo-card_card__nNmEk" //avatar ads
                  ];


//init background
var day = new Date().getDate();
var background_URL;
if (dailyBackground) {background_URL = await GM.getResourceUrl("bg"+day); }
else {background_URL = await GM.getResourceUrl(singleBackground);}

//init single player and multiplayer icons
var multi_country_URL = await GM.getResourceUrl("multi_country");
var multi_duel_URL = await GM.getResourceUrl("multi_duel");
var multi_distance_URL = await GM.getResourceUrl("multi_distance");
var multi_season_icon_URL = await GM.getResourceUrl("multi_season_icon");
var single_quickplay_URL = await GM.getResourceUrl("single_quickplay");
var single_maprunner_URL = await GM.getResourceUrl("single_maprunner");
var single_classic_URL = await GM.getResourceUrl("single_classic");
var single_explorer_URL = await GM.getResourceUrl("single_explorer");
var single_streak_URL = await GM.getResourceUrl("single_streak");
var single_daily_URL = await GM.getResourceUrl("single_daily");
var live_icon_URL = await GM.getResourceUrl("live_icon");

//call the main function at regular intervals
var nIntervId = setInterval(removeReturningNodes, 250);


//------------------------------------------------------------------------------------------------------MAIN FUNCTION---------------------------------------------------------------------------------------------\\
function removeReturningNodes() {

    //remove unwanted elements
    for (var i=0;i<elementList.length;i++) {
        var el = document.getElementsByClassName(elementList[i]);
        if (el != undefined) {
            if (el.length>0) { el[0].style.display = "none";}
        }
    }

    //apply background
    removeBackground();
    //apply icons in single player menu
    if (singlePlayerIcons) {changeSinglePlayerImages();}
    //apply icons in multiplyer menu
    if (multiplayerIcons) {changeMultiplayerImages();}
}


//------------------------------------------------------------------------------------------------------BACKGROUNDS---------------------------------------------------------------------------------------------\\
function removeBackground() {

    var body = document.getElementsByTagName('body')[0];
    body.style.background = 'transparent';
    body.style.backgroundImage = "url("+ background_URL +")";
    body.style.backgroundRepeat = "no-repeat";
    body.style.backgroundSize = "100% 100%";

    if (mainPageBackground) {
    var backgroundMainPage = document.getElementsByClassName("background_backgroundHome__lurxW");
    if (backgroundMainPage != undefined) {
        if (backgroundMainPage.length > 0 ) {
            let backgroundElement = backgroundMainPage[0];
            $(backgroundElement).removeClass ("background_wrapper__OlrxG");
            $(backgroundElement).removeClass ("background_backgroundHome__lurxW");
        }
    }
    }

    if (menusBackground) {
      var backgroundMultiplayerMenu = document.getElementsByClassName("background_backgroundMultiplayer__TLhIS");
        if (backgroundMultiplayerMenu != undefined) {
        if (backgroundMultiplayerMenu.length >0) {
            let backgroundElement =backgroundMultiplayerMenu[0];
            $(backgroundElement).removeClass ("background_wrapper__OlrxG");
            $(backgroundElement).removeClass ("background_backgroundMultiplayer__TLhIS");
        }
    }
    }

    if (lobbyBackground) {
    var backgroundMultiplayerLobby = document.getElementsByClassName("in-game_root__3hGRu in-game_backgroundDefault__UDbvo"); // "party_root__EQz_N party_withSideTray__Ffx0K"
        if (backgroundMultiplayerLobby != undefined) {
            if (backgroundMultiplayerLobby.length >0) {
                let backgroundElement = backgroundMultiplayerLobby[0];
                $(backgroundElement).removeClass ("in-game_backgroundDefault__UDbvo");
        }
        }

        var backgroundMultiplayerLobby2 = document.getElementsByClassName("party_root__EQz_N party_withSideTray__Ffx0K"); //
        if (backgroundMultiplayerLobby2 != undefined) {
            if (backgroundMultiplayerLobby2.length >0) {
                let backgroundElement = backgroundMultiplayerLobby2[0];
                $(backgroundElement).removeClass ("party_root__EQz_N");
                backgroundElement.style.display = "grid";
                backgroundElement.style.flexGrow = "1";
                backgroundElement.style.gridTemplateRows = "5rem 1fr auto";
        }
        }

        var backgroundMultiplayerLobbyBottom = document.getElementsByClassName("party-footer_root__Rz_io");
        if (backgroundMultiplayerLobbyBottom != undefined) {
            if (backgroundMultiplayerLobbyBottom.length >0) {
                let backgroundElement = backgroundMultiplayerLobbyBottom[0];
               $(backgroundElement).removeClass ("party-footer_root__Rz_io");
                backgroundElement.style.alignItems = "center";
                backgroundElement.style.boxSizing = "border-box";
                backgroundElement.style.display = "flex";
                backgroundElement.style.flexDirection = "column";
                backgroundElement.style.maxWidth = "100vw";
        }
        }
    }


}

//------------------------------------------------------------------------------------------------------SINGLE PLAYER MENU---------------------------------------------------------------------------------------------\\
function changeSinglePlayerImages() {

    var layoutList = document.getElementsByClassName("screens_root__S_Vos screens_focusCardWrapper__8iorp");
        if (layoutList != undefined) {
            if (layoutList .length >0) {
                let Element = layoutList[0];
                Element.style.minWidth = "var(--containerWidth)";
                Element.style.display = "grid";
                Element.style.gap = "2vw";
                Element.style.gridTemplateArea = "main secondary tertiary";
                Element.style.gridTemplateColumns = "repeat(3,minmax(0,1fr))";
                Element.style.transition = "filter .6s ease";
                $(Element).removeClass("screens_root__S_Vos");
                $(Element).removeClass("screens_focusCardWrapper__8iorp");
            }
        }


    var singlePlayerQuickplayList = document.getElementsByClassName("screens_card__WP0M0 screens_card__WP0M0 screens_quickplayCard__gIeOx");
    if (singlePlayerQuickplayList != undefined) {
        if (singlePlayerQuickplayList.length >0) {
            let Element = singlePlayerQuickplayList[0];
            $(Element).removeClass("screens_quickplayCard__gIeOx");
            Element.style.backgroundColor = bg_color;
            Element.firstChild.style.flex = "1";
            Element.style.justifyContent = "center";
            let newImg = document.createElement('img');
            newImg.style.maxHeight = "40%";
            newImg.style.objectFit = "contain";
            newImg.src = single_quickplay_URL;
            Element.insertBefore(newImg, Element.firstChild);
        }
    }

    var singlePlayerMaprunnerList = document.getElementsByClassName("screens_card__WP0M0 screens_card__WP0M0 screens_maprunnerCard__o_Ulp");
    if (singlePlayerMaprunnerList != undefined) {
        if (singlePlayerMaprunnerList.length >0) {
            let Element = singlePlayerMaprunnerList[0];
            $(Element).removeClass("screens_maprunnerCard__o_Ulp");
            Element.style.backgroundColor = bg_color;
            Element.style.justifyContent = "center";
            let newImg = document.createElement('img');
            newImg.style.maxHeight = "40%";
            newImg.style.objectFit = "contain";
            newImg.src = single_maprunner_URL;
            Element.insertBefore(newImg, Element.firstChild);
        }
    }
    var singlePlayerClassicList = document.getElementsByClassName("screens_card__WP0M0 screens_card__WP0M0 screens_mapsCard__oXg2H");
        if (singlePlayerClassicList != undefined) {
        if (singlePlayerClassicList.length >0) {
            let Element = singlePlayerClassicList[0];
            $(Element).removeClass("screens_mapsCard__oXg2H");
            Element.style.backgroundColor = bg_color;
            Element.style.justifyContent = "center";
            Element.firstChild.firstChild.style.display = "none";
            Element.firstChild.children[1].innerHTML = "CLASSIC MAPS";
            let newImg = document.createElement('img');
            newImg.style.maxHeight = "40%";
            newImg.style.objectFit = "contain";
            newImg.src = single_classic_URL;
            Element.insertBefore(newImg, Element.firstChild);
        }
    }

    var singlePlayerStreakList = document.getElementsByClassName("screens_card__WP0M0 screens_card__WP0M0 screens_streaksCard__cvcTt");
            if (singlePlayerStreakList != undefined) {
        if (singlePlayerStreakList.length >0) {
            let Element = singlePlayerStreakList[0];
            $(Element).removeClass("screens_streaksCard__cvcTt");
            Element.style.backgroundColor = bg_color;
            Element.style.justifyContent = "center";
            let newImg = document.createElement('img');
            newImg.style.maxHeight = "40%";
            newImg.style.objectFit = "contain";
            newImg.src = single_streak_URL;
            Element.insertBefore(newImg, Element.firstChild);
        }
    }

        var singlePlayerExplorerList = document.getElementsByClassName("screens_card__WP0M0 screens_card__WP0M0 screens_explorerCard__BAf3R");
            if (singlePlayerExplorerList != undefined) {
        if (singlePlayerExplorerList.length >0) {
            let Element = singlePlayerExplorerList[0];
            $(Element).removeClass("screens_explorerCard__BAf3R");
            Element.style.backgroundColor = bg_color;
            Element.style.justifyContent = "center";
            let newImg = document.createElement('img');
            newImg.style.maxHeight = "40%";
            newImg.style.objectFit = "contain";
            newImg.src = single_explorer_URL;
            Element.insertBefore(newImg, Element.firstChild);
        }
    }

            var singlePlayerDailyList = document.getElementsByClassName("screens_card__WP0M0 screens_card__WP0M0 screens_dailyCard___jMGE");
            if (singlePlayerDailyList != undefined) {
        if (singlePlayerDailyList.length >0) {
            let Element = singlePlayerDailyList[0];
            $(Element).removeClass("screens_dailyCard___jMGE");
            Element.style.backgroundColor = bg_color;
            Element.style.justifyContent = "center";
            let newImg = document.createElement('img');
            newImg.style.maxHeight = "40%";
            newImg.style.objectFit = "contain";
            newImg.src = single_daily_URL;
            Element.insertBefore(newImg, Element.firstChild);
        }
    }

}

//------------------------------------------------------------------------------------------------------MULTIPLAYER MENU---------------------------------------------------------------------------------------------\\

function changeMultiplayerImages() {

 var multiplayerBackgroundList = document.getElementsByClassName("ranked_root__h__6e");
     if (multiplayerBackgroundList != undefined) {
        if (multiplayerBackgroundList.length >0) {
            multiplayerBackgroundList[0].style.backgroundColor = bg_color;
        }
     }

  multiplayerBackgroundList = document.getElementsByClassName("tournament-card_card__fkNsg");
     if (multiplayerBackgroundList != undefined) {
        if (multiplayerBackgroundList.length >0) {
            multiplayerBackgroundList[0].style.backgroundColor = bg_color;
        }
     }

    var unrankedCountryList = document.getElementsByClassName("unranked_card__6DqeB unranked_brc__xHUjF");
         if (unrankedCountryList != undefined) {
        if (unrankedCountryList.length >0) {
            let Element = unrankedCountryList[0];
            $(Element).removeClass("unranked_brc__xHUjF");
            Element.style.backgroundPosition = "50%";
            Element.style.backgroundRepeat = "no-repeat";
            Element.style.borderRadius = "0.5rem";
            Element.style.boxSizing = "border-box";
            Element.style.color = "white";
            Element.style.cursor = "pointer";
            Element.style.height = "100%";
            Element.style.padding = "2rem";
            Element.style.backgroundColor = bg_color;
            Element.style.backgroundImage = "url("+ multi_country_URL +")";
        }
     }

        var rankedCountryList = document.getElementsByClassName("play_gameModeCard__zSeBo play_active__t661_");
         if (rankedCountryList != undefined) {
        if (rankedCountryList.length >0) {
            rankedCountryList[0].style.backgroundImage = "";
            rankedCountryList[0].style.backgroundColor = bg_color_darker;
        }
     }

        var rankedDistanceList = document.getElementsByClassName("play_gameModeCard__zSeBo play_active__t661_");
         if (rankedDistanceList != undefined) {
        if (rankedDistanceList.length >1) {
            rankedDistanceList[1].style.backgroundImage = "";
            rankedDistanceList[1].style.backgroundColor = bg_color_darker;
        }
     }

        var rankedDuelList = document.getElementsByClassName("play_gameModeCard__zSeBo play_active__t661_");
         if (rankedDuelList != undefined) {
        if (rankedDuelList.length >2) {
            rankedDuelList[2].style.backgroundImage = "";
            rankedDuelList[2].style.backgroundColor = bg_color_darker;
        }
     }

        var unrankedDistanceList = document.getElementsByClassName("unranked_brd__avH20");
         if (unrankedDistanceList != undefined) {
        if (unrankedDistanceList.length >0) {
            let Element = unrankedDistanceList[0];
            $(Element).removeClass("unranked_brd__avH20");
            Element.style.backgroundPosition = "50%";
            Element.style.backgroundRepeat = "no-repeat";
            Element.style.borderRadius = "0.5rem";
            Element.style.boxSizing = "border-box";
            Element.style.color = "white";
            Element.style.cursor = "pointer";
            Element.style.height = "100%";
            Element.style.padding = "2rem";
            Element.style.backgroundColor = bg_color;
            Element.style.backgroundImage = "url("+ multi_distance_URL +")";
        }
     }




        var unrankedDuelList = document.getElementsByClassName("unranked_card__6DqeB unranked_td__EL4y2");
         if (unrankedDuelList != undefined) {
        if (unrankedDuelList.length >0) {
            let Element = unrankedDuelList[0];
            $(Element).removeClass("unranked_td__EL4y2");
            Element.style.backgroundPosition = "50%";
            Element.style.backgroundRepeat = "no-repeat";
            Element.style.borderRadius = "0.5rem";
            Element.style.boxSizing = "border-box";
            Element.style.color = "white";
            Element.style.cursor = "pointer";
            Element.style.height = "100%";
            Element.style.padding = "2rem";
            Element.style.backgroundColor = bg_color;
            Element.style.backgroundImage = "url("+ multi_duel_URL +")";
        }
     }
    var seasonIconList = document.getElementsByClassName("season-icon_icon__bBPys");
     if (seasonIconList != undefined) {
        if (seasonIconList.length >0) {
            seasonIconList[0].firstChild.src = multi_season_icon_URL;
            seasonIconList[0].firstChild.style.borderRadius = "7px";
            seasonIconList[0].firstChild.width = "100%";
            seasonIconList[0].firstChild.height = "50%";
        }
     }

    var liveChallengeList = document.getElementsByClassName("footer-controls_gameModeIcon__0eE5e footer-controls_liveChallengeCorrection__nuutg");
    if (liveChallengeList != undefined) {
        if (liveChallengeList.length >0) {
            liveChallengeList[0].src = live_icon_URL;
        }
     }
}

